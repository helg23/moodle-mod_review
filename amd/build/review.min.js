define(["jquery","core/ajax","jqueryui"],function(a,b){return{init:function(){var c=function(c){c.preventDefault();var d=0,e=0,f=a(this),g=f.attr("class").split(/\s+/);a.each(g,function(a,b){if(b.startsWith("yfdr")){var c=b.split(/_/);d=c[1],e=c[2]}}),f.css("opacity","0.3");var h=b.call([{methodname:"mod_review_save_rate",args:{reviewid:d,rate:e}}]);h[0].done(function(b){1===b.result&&(a(".your_rate_stars a.star").each(function(){var b=0;a.each(a(this).attr("class").split(/\s+/),function(a,c){if(c.startsWith("yfdr")){var d=c.split(/_/);b=d[2]}}),a(this).toggleClass("star_notempty",b<=e)}),a("#review_rate"+b.userreview_id+" span.star").each(function(){a(this).toggleClass("star_notempty",a(this).data("rate")<=e)}),a("#rates_stat_container").html(b.stat),f.css("opacity","1").slow(3e3))}).fail(function(){alert("save rate error"),f.css("opacity","1")})},d={containment:"parent",grid:[20,50],stop:function(c,e){var f=a(c.target),g=f.data("reviewid"),h=Math.round(e.position.left/20)+1,i=b.call([{methodname:"mod_review_save_status",args:{user_reviewid:g,status:h}}]);i[0].done(function(b){1===b.result&&(a("#status_container"+g).html(b.switcher),a(".status_switcher .status.draggable").draggable(d))}).fail(function(){alert("save status error")})}},e=function(c){c.preventDefault();var e=a(this),f=e.data("reviewid"),g=e.data("status"),h=b.call([{methodname:"mod_review_save_status",args:{user_reviewid:f,status:g}}]);h[0].done(function(b){1===b.result&&(a("#status_container"+f).html(b.switcher),a(".status_switcher .status.draggable").draggable(d))}).fail(function(){alert("save status error")})};a(".your_rate_stars .star").click(c),a(document).on("click",".status_switcher .status",e),a(".status_switcher .status.draggable").draggable(d)}}});