define(["jquery","core/ajax","jqueryui"],function(t,a){return{init:function(){var s={containment:"parent",grid:[20,50],stop:function(e,r){var i=t(e.target).data("reviewid"),n=Math.round(r.position.left/20)+1;a.call([{methodname:"mod_review_save_status",args:{user_reviewid:i,status:n}}])[0].done(function(a){1===a.result&&(t("#status_container"+i).html(a.switcher),t(".status_switcher .status.draggable").draggable(s))})}};t(".your_rate_stars .star").click(function(s){s.preventDefault();var e=0,r=0,i=t(this),n=i.attr("class").split(/\s+/);t.each(n,function(t,a){if(a.startsWith("yfdr")){var s=a.split(/_/);e=s[1],r=s[2]}}),i.css("opacity","0.3"),a.call([{methodname:"mod_review_save_rate",args:{reviewid:e,rate:r}}])[0].done(function(a){1===a.result&&(t(".your_rate_stars a.star").each(function(){var a=0;t.each(t(this).attr("class").split(/\s+/),function(t,s){if(s.startsWith("yfdr")){var e=s.split(/_/);a=e[2]}}),t(this).toggleClass("star_notempty",a<=r)}),t("#review_rate"+a.userreview_id+" span.star").each(function(){t(this).toggleClass("star_notempty",t(this).data("rate")<=r)}),t("#rates_stat_container").html(a.stat),i.css("opacity","1").slow(3e3))}).fail(function(){i.css("opacity","1")})}),t(document).on("click",".status_switcher .status",function(e){e.preventDefault();var r=t(this),i=r.data("reviewid"),n=r.data("status");a.call([{methodname:"mod_review_save_status",args:{user_reviewid:i,status:n}}])[0].done(function(a){1===a.result&&(t("#status_container"+i).html(a.switcher),t(".status_switcher .status.draggable").draggable(s))})}),t(".status_switcher .status.draggable").draggable(s)}}});